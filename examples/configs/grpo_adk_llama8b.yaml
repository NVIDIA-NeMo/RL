# GRPO configuration for unique numbers environment
defaults: "grpo_math_8B.yaml"

grpo:
  num_prompts_per_step: 32
  num_generations_per_prompt: 16
  max_rollout_turns: 20
  max_num_steps: 100
  val_at_start: false

data:
  add_system_prompt: false

checkpointing:
  enabled: false
  checkpoint_dir: "results/grpo-adk"
  metric_name: "val_reward"
  higher_is_better: true
  keep_top_k: 3
  save_period: 10

env:
  unique_numbers:
    cfg:
      max_turns: 15
      min_length: 5
      max_length: 10
      max_integer: 15

logger:
  wandb_enabled: True 
  wandb:
    project: "grpo-simulated-adk"
    name: "llama-8b-__NOW__"

policy:
  tokenizer:
    chat_template: "{% for message in messages %}{% if loop.first %}<|begin_of_text|>{% endif %}<|start_header_id|>{{ message['role'] }}<|end_header_id|>\n{{ message['content'] }}<|eot_id|>{% endfor %}<|start_header_id|>assistant<|end_header_id|>\n"
   
cluster:
  gpus_per_node: 8