defaults:
  - ../../grpo_math_1B.yaml
  - grpo-acereason-math-7b-16K.yaml
loss_fn:
  ratio_clip_c: 3
  reference_policy_kl_penalty: 0.0001
policy:
  max_total_sequence_length: 32768
  logprob_batch_size: 2
  dtensor_cfg:
    activation_checkpointing: true
    context_parallel_size: 4
  dynamic_batching:
    logprob_mb_tokens: 65536
    train_mb_tokens: 32768
  sequence_packing:
    enabled: false
    logprob_mb_tokens: 65536
    train_mb_tokens: 32768
  optimizer:
    kwargs:
      lr: 5.0e-07
  generation:
    max_new_tokens: 32768
    vllm_cfg:
      max_model_len: 32768
      gpu_memory_utilization: 0.8
      enforce_eager: true
      tensor_parallel_size: 4
data:
  max_input_seq_length: 32768

