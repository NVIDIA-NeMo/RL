# GRPO Algorithm Configuration
# A copy of examples/configs/grpo_math_1B.yaml with modifications for `policy.generation.expose_http_server: true`
defaults: "grpo_dapo17k_qwen3_4binstruct.yaml"

grpo:
  num_generations_per_prompt: 16
  num_prompts_per_step: 64

loss_fn:
  reference_policy_kl_penalty: 0

policy:
  max_total_sequence_length: 32768
  train_global_batch_size: ${grpo.num_prompts_per_step}  # Match the num prompts per step
  train_micro_batch_size: 1
  logprob_batch_size: 1

  dtensor_cfg:
    tensor_parallel_size: 2
