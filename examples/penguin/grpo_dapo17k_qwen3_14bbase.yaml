# GRPO Algorithm Configuration
# A copy of examples/configs/grpo_math_1B.yaml with modifications for `policy.generation.expose_http_server: true`
defaults: "grpo_dapo17k_qwen3_4binstruct_nf.yaml"

grpo:
  num_generations_per_prompt: 16
  num_prompts_per_step: 512

loss_fn:
  ratio_clip_c: 3  # Not sure what this does

policy:
  max_total_sequence_length: 16384
  train_global_batch_size: ${grpo.num_prompts_per_step}  # Match the num prompts per step
  train_micro_batch_size: 1
  logprob_batch_size: 1

  dtensor_cfg:
    tensor_parallel_size: 4
